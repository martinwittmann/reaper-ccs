initial_state:
  DISPLAY: encoders
  CURRENT_COLOR: $PART1_COLOR

on_activate:
  - "[page.set_selected_part]"
  - conditions:
      $_STATE.DISPLAY.is: encoders
    actions:
      - "[slmk3.start_buffer:screen_properties]"
      - "[page.display_encoders]"
      - "[slmk3.stop_buffer:screen_properties]"
      - "[slmk3.flush_buffer:screen_properties]"

  - conditions:
      $_STATE.DISPLAY.is: buttons
    actions:
      - "[page.display_buttons]"

  - conditions:
      $_STATE.DISPLAY.is: faders
    actions:
      - "[page.display_faders]"

# To save lots of repetition, allow settings defaults that can be overriden
# on each page.
# This is useful if variables and mappings should stay the same on all pages.
variables:
  SCREEN1: 00
  SCREEN2: 01
  SCREEN3: 02
  SCREEN4: 03
  SCREEN5: 04
  SCREEN6: 05
  SCREEN7: 06
  SCREEN8: 07

  CENTER_SCREEN: 08

  COLOR_OFF: 00

  COLOR_LIGHT_BLUE: 25
  COLOR_RED: 05
  COLOR_YELLOW: 0D
  COLOR_VIOLET: 36
  COLOR_ORANGE: 54
  COLOR_WHITE: 03
  COLOR_GREEN: 15
  COLOR_DARK_BLUE: 28

  PART1_LABEL: Juno 1
  PART2_LABEL: Juno 2
  PART3_LABEL: Vital
  PART4_LABEL: 
  PART5_LABEL: 
  PART6_LABEL: 
  PART7_LABEL: 
  PART8_LABEL: Mixer

  PART1_COLOR: 25
  PART2_COLOR: 05
  PART3_COLOR: 0D
  PART4_COLOR: 36
  PART5_COLOR: 54
  PART6_COLOR: 03
  PART7_COLOR: 15
  PART8_COLOR: 28

  COLOR1: 25
  COLOR2: 05
  COLOR3: 0D
  COLOR4: 36
  COLOR5: 54
  COLOR6: 03
  COLOR7: 15
  COLOR8: 28

  BUTTON1: 33
  BUTTON2: 34
  BUTTON3: 35
  BUTTON4: 36
  BUTTON5: 37
  BUTTON6: 38
  BUTTON7: 39
  BUTTON8: 3A
  BUTTON9: 3B
  BUTTON10: 3C
  BUTTON11: 3D
  BUTTON12: 3E
  BUTTON13: 3F
  BUTTON14: 40
  BUTTON15: 41
  BUTTON16: 42
  BUTTON17: 43
  BUTTON18: 44
  BUTTON19: 45
  BUTTON20: 46
  BUTTON21: 47
  BUTTON22: 48
  BUTTON23: 49
  BUTTON24: 4A

  BUTTON9_LABEL:  Pulse
  BUTTON10_LABEL: Saw
  BUTTON11_LABEL: Sub
  BUTTON12_LABEL: F-Env
  BUTTON13_LABEL: A-Env/G
  BUTTON14_LABEL: PwmMode
  BUTTON15_LABEL: Chor I
  BUTTON16_LABEL: Chor II

  BUTTON17_LABEL: LfoTrMd
  BUTTON18_LABEL: LfoShape
  BUTTON19_LABEL: GldeType
  BUTTON20_LABEL: GldePoly
  BUTTON21_LABEL: ""
  BUTTON22_LABEL: ""
  BUTTON23_LABEL: ""
  BUTTON24_LABEL: ""

  BUTTON_SCREEN_UP: 51
  BUTTON_SCREEN_DOWN: 52

  BUTTON_RIGHT_UP: 57
  BUTTON_RIGHT_DOWN: 58

  FADER1: 29
  FADER2: 2A
  FADER3: 2B
  FADER4: 2C
  FADER5: 2D
  FADER6: 2E
  FADER7: 2F
  FADER8: 30

  FADER1_LABEL: Frequ
  FADER2_LABEL: Res.
  FADER3_LABEL: Sub
  FADER4_LABEL: Noise
  FADER5_LABEL: Attack
  FADER6_LABEL: Decay
  FADER7_LABEL: Sustain
  FADER8_LABEL: Release

  C_LEFT_BAR: 00
  C_RIGHT_TOP_BAR: 01
  C_RIGHT_BOTTOM_BAR: 02


actions:
  set_selected_part:
    actions:
      - "[slmk3.start_buffer:screen_properties]"
      - conditions:
          $_STATE.DISPLAY.is: encoders
        actions:
        - "[slmk3.sc_set_knob_lower_text_selected:$SCREEN1:00]"
        - "[slmk3.sc_set_knob_lower_text_selected:$SCREEN2:00]"
        - "[slmk3.sc_set_knob_lower_text_selected:$SCREEN3:00]"
        - "[slmk3.sc_set_knob_lower_text_selected:$SCREEN4:00]"
        - "[slmk3.sc_set_knob_lower_text_selected:$SCREEN5:00]"
        - "[slmk3.sc_set_knob_lower_text_selected:$SCREEN6:00]"
        - "[slmk3.sc_set_knob_lower_text_selected:$SCREEN7:00]"
        - "[slmk3.sc_set_knob_lower_text_selected:$SCREEN8:00]"
        - "[slmk3.sc_set_knob_lower_text_selected:$SCREEN_COLUMN:01]"

      - conditions:
          $_STATE.DISPLAY.is: buttons
        actions:
        - "[slmk3.sc_set_bottom_box_selected:$SCREEN1:00]"
        - "[slmk3.sc_set_bottom_box_selected:$SCREEN2:00]"
        - "[slmk3.sc_set_bottom_box_selected:$SCREEN3:00]"
        - "[slmk3.sc_set_bottom_box_selected:$SCREEN4:00]"
        - "[slmk3.sc_set_bottom_box_selected:$SCREEN5:00]"
        - "[slmk3.sc_set_bottom_box_selected:$SCREEN6:00]"
        - "[slmk3.sc_set_bottom_box_selected:$SCREEN7:00]"
        - "[slmk3.sc_set_bottom_box_selected:$SCREEN8:00]"
        - "[slmk3.sc_set_bottom_box_selected:$SCREEN_COLUMN:01]"

      - "[slmk3.stop_buffer:screen_properties]"


      - "[slmk3.set_button_color:$BUTTON1:$COLOR_OFF]"
      - "[slmk3.set_button_color:$BUTTON2:$COLOR_OFF]"
      - "[slmk3.set_button_color:$BUTTON3:$COLOR_OFF]"
      - "[slmk3.set_button_color:$BUTTON4:$COLOR_OFF]"
      - "[slmk3.set_button_color:$BUTTON5:$COLOR_OFF]"
      - "[slmk3.set_button_color:$BUTTON6:$COLOR_OFF]"
      - "[slmk3.set_button_color:$BUTTON7:$COLOR_OFF]"
      - "[slmk3.set_button_color:$BUTTON8:$COLOR_OFF]"
      - "[slmk3.set_button_color:$PAGE_BUTTON:$PAGE_COLOR]"

  display_encoders:
    actions:
    - "[slmk3.set_button_color:$BUTTON_SCREEN_DOWN:$COLOR_OFF]"
    - "[slmk3.set_button_color:$BUTTON_SCREEN_UP:$COLOR_WHITE]"
    - "[slmk3.set_button_color:$BUTTON_RIGHT_UP:$COLOR_OFF]"
    - "[slmk3.set_button_color:$BUTTON_RIGHT_DOWN:$COLOR_OFF]"

    - "[slmk3.set_knob_layout]"

    - "[slmk3.start_buffer:screen_properties]"

    - "[slmk3.sc_set_knob_color:$SCREEN1:$COLOR_WHITE]"
    - "[slmk3.sc_set_knob_color:$SCREEN2:$COLOR_WHITE]"
    - "[slmk3.sc_set_knob_color:$SCREEN3:$COLOR_WHITE]"
    - "[slmk3.sc_set_knob_color:$SCREEN4:$COLOR_WHITE]"
    - "[slmk3.sc_set_knob_color:$SCREEN5:$COLOR_WHITE]"
    - "[slmk3.sc_set_knob_color:$SCREEN6:$COLOR_WHITE]"
    - "[slmk3.sc_set_knob_color:$SCREEN7:$COLOR_WHITE]"
    - "[slmk3.sc_set_knob_color:$SCREEN8:$COLOR_WHITE]"
 
    - "[slmk3.sc_set_knob_label:$SCREEN1:$ENCODER1_LABEL]"
    - "[slmk3.sc_set_knob_label:$SCREEN2:$ENCODER2_LABEL]"
    - "[slmk3.sc_set_knob_label:$SCREEN3:$ENCODER3_LABEL]"
    - "[slmk3.sc_set_knob_label:$SCREEN4:$ENCODER4_LABEL]"
    - "[slmk3.sc_set_knob_label:$SCREEN5:$ENCODER5_LABEL]"
    - "[slmk3.sc_set_knob_label:$SCREEN6:$ENCODER6_LABEL]"
    - "[slmk3.sc_set_knob_label:$SCREEN7:$ENCODER7_LABEL]"
    - "[slmk3.sc_set_knob_label:$SCREEN8:$ENCODER8_LABEL]"

    - "[slmk3.sc_set_knob_bottom_label:$SCREEN1:$PART1_LABEL]"
    - "[slmk3.sc_set_knob_bottom_label:$SCREEN2:$PART2_LABEL]"
    - "[slmk3.sc_set_knob_bottom_label:$SCREEN3:$PART3_LABEL]"
    - "[slmk3.sc_set_knob_bottom_label:$SCREEN4:$PART4_LABEL]"
    - "[slmk3.sc_set_knob_bottom_label:$SCREEN5:$PART5_LABEL]"
    - "[slmk3.sc_set_knob_bottom_label:$SCREEN6:$PART6_LABEL]"
    - "[slmk3.sc_set_knob_bottom_label:$SCREEN7:$PART7_LABEL]"
    - "[slmk3.sc_set_knob_bottom_label:$SCREEN8:$PART8_LABEL]"

    - "[slmk3.sc_set_knob_bottom_color:$SCREEN1:$PART1_COLOR]"
    - "[slmk3.sc_set_knob_bottom_color:$SCREEN2:$PART1_COLOR]"
    - "[slmk3.sc_set_knob_bottom_color:$SCREEN3:$PART2_COLOR]"
    - "[slmk3.sc_set_knob_bottom_color:$SCREEN4:$COLOR_OFF]"
    - "[slmk3.sc_set_knob_bottom_color:$SCREEN5:$COLOR_OFF]"
    - "[slmk3.sc_set_knob_bottom_color:$SCREEN6:$COLOR_OFF]"
    - "[slmk3.sc_set_knob_bottom_color:$SCREEN7:$COLOR_OFF]"
    - "[slmk3.sc_set_knob_bottom_color:$SCREEN8:$PART8_COLOR]"

    - "[slmk3.sc_set_knob_top_bar_color:$SCREEN1:$PAGE_COLOR]"
    - "[slmk3.sc_set_knob_top_bar_color:$SCREEN2:$PAGE_COLOR]"
    - "[slmk3.sc_set_knob_top_bar_color:$SCREEN3:$PAGE_COLOR]"
    - "[slmk3.sc_set_knob_top_bar_color:$SCREEN4:$PAGE_COLOR]"
    - "[slmk3.sc_set_knob_top_bar_color:$SCREEN5:$PAGE_COLOR]"
    - "[slmk3.sc_set_knob_top_bar_color:$SCREEN6:$PAGE_COLOR]"
    - "[slmk3.sc_set_knob_top_bar_color:$SCREEN7:$PAGE_COLOR]"
    - "[slmk3.sc_set_knob_top_bar_color:$SCREEN8:$PAGE_COLOR]"

    - "[slmk3.sc_set_center_screen_right_bar_color:$C_RIGHT_TOP_BAR:$COLOR_OFF]"
    - "[slmk3.sc_set_center_screen_right_bar_color:$C_RIGHT_BOTTOM_BAR:$COLOR_OFF]"


    - "[slmk3.stop_buffer:screen_properties]"

    - "[slmk3.set_fader_color:$FADER1:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER2:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER3:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER4:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER5:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER6:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER7:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER8:$COLOR_OFF]"

    - "[page.set_state:DISPLAY:encoders]"

  display_buttons:
    actions:
    - "[slmk3.set_button_color:$BUTTON_SCREEN_DOWN:$COLOR_OFF]"
    - "[slmk3.set_button_color:$BUTTON_SCREEN_UP:$COLOR_OFF]"
    - "[slmk3.set_button_color:$BUTTON_RIGHT_UP:$COLOR_WHITE]"
    - "[slmk3.set_button_color:$BUTTON_RIGHT_DOWN:$COLOR_OFF]"

    - "[slmk3.set_box_layout]"

    - "[slmk3.start_buffer:screen_properties]"

    - "[slmk3.sc_set_top_box_label:$SCREEN1:$BUTTON9_LABEL]"
    - "[slmk3.sc_set_top_box_label:$SCREEN2:$BUTTON10_LABEL]"
    - "[slmk3.sc_set_top_box_label:$SCREEN3:$BUTTON11_LABEL]"
    - "[slmk3.sc_set_top_box_label:$SCREEN4:$BUTTON12_LABEL]"
    - "[slmk3.sc_set_top_box_label:$SCREEN5:$BUTTON13_LABEL]"
    - "[slmk3.sc_set_top_box_label:$SCREEN6:$BUTTON14_LABEL]"
    - "[slmk3.sc_set_top_box_label:$SCREEN7:$BUTTON15_LABEL]"
    - "[slmk3.sc_set_top_box_label:$SCREEN8:$BUTTON16_LABEL]"

    - "[slmk3.sc_set_top_box_color:$SCREEN1:$COLOR1]"
    - "[slmk3.sc_set_top_box_color:$SCREEN2:$COLOR2]"
    - "[slmk3.sc_set_top_box_color:$SCREEN3:$COLOR3]"
    - "[slmk3.sc_set_top_box_color:$SCREEN4:$COLOR4]"
    - "[slmk3.sc_set_top_box_color:$SCREEN5:$COLOR5]"
    - "[slmk3.sc_set_top_box_color:$SCREEN6:$COLOR6]"
    - "[slmk3.sc_set_top_box_color:$SCREEN7:$COLOR7]"
    - "[slmk3.sc_set_top_box_color:$SCREEN8:$COLOR8]"

    - "[slmk3.sc_set_center_box_label:$SCREEN1:$BUTTON17_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN2:$BUTTON18_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN3:$BUTTON19_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN4:$BUTTON20_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN5:$BUTTON21_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN6:$BUTTON22_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN7:$BUTTON23_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN8:$BUTTON24_LABEL]"

    - "[slmk3.sc_set_center_box_color:$SCREEN1:$COLOR1]"
    - "[slmk3.sc_set_center_box_color:$SCREEN2:$COLOR2]"
    - "[slmk3.sc_set_center_box_color:$SCREEN3:$COLOR3]"
    - "[slmk3.sc_set_center_box_color:$SCREEN4:$COLOR4]"
    - "[slmk3.sc_set_center_box_color:$SCREEN5:$COLOR5]"
    - "[slmk3.sc_set_center_box_color:$SCREEN6:$COLOR6]"
    - "[slmk3.sc_set_center_box_color:$SCREEN7:$COLOR7]"
    - "[slmk3.sc_set_center_box_color:$SCREEN8:$COLOR8]"

    - "[slmk3.sc_set_bottom_box_label:$SCREEN1:$PART1_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN2:$PART2_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN3:$PART3_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN4:$PART4_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN5:$PART5_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN6:$PART6_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN7:$PART7_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN8:$PART8_LABEL]"

    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN1:$PART1_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN2:$PART1_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN3:$PART1_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN4:$PART4_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN5:$PART5_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN6:$PART6_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN7:$PART7_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN8:$PART8_COLOR]"

    - "[slmk3.sc_set_center_screen_right_bar_color:$C_RIGHT_TOP_BAR:$PAGE_COLOR]"
    - "[slmk3.sc_set_center_screen_right_bar_color:$C_RIGHT_BOTTOM_BAR:$PAGE_COLOR]"

    - "[slmk3.stop_buffer:screen_properties]"

    - "[slmk3.set_fader_color:$FADER1:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER2:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER3:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER4:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER5:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER6:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER7:$COLOR_OFF]"
    - "[slmk3.set_fader_color:$FADER8:$COLOR_OFF]"

    - "[page.set_state:DISPLAY:buttons]"

  display_faders:
    actions:
    - "[slmk3.set_button_color:$BUTTON_SCREEN_DOWN:$COLOR_OFF]"
    - "[slmk3.set_button_color:$BUTTON_SCREEN_UP:$COLOR_OFF]"
    - "[slmk3.set_button_color:$BUTTON_RIGHT_UP:$COLOR_OFF]"
    - "[slmk3.set_button_color:$BUTTON_RIGHT_DOWN:$COLOR_WHITE]"

    - "[slmk3.set_box_layout]"

    - "[slmk3.start_buffer:screen_properties]"

    - "[slmk3.sc_set_top_box_label:$SCREEN1:Fader 1]"
    - "[slmk3.sc_set_top_box_label:$SCREEN2:Fader 1]"
    - "[slmk3.sc_set_top_box_label:$SCREEN3:Fader 3]"
    - "[slmk3.sc_set_top_box_label:$SCREEN4:Fader 4]"
    - "[slmk3.sc_set_top_box_label:$SCREEN5:Fader 5]"
    - "[slmk3.sc_set_top_box_label:$SCREEN6:Fader 6]"
    - "[slmk3.sc_set_top_box_label:$SCREEN7:Fader 7]"
    - "[slmk3.sc_set_top_box_label:$SCREEN8:Fader 8]"

    - "[slmk3.sc_set_center_box_label:$SCREEN1:$FADER1_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN2:$FADER2_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN3:$FADER3_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN4:$FADER4_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN5:$FADER5_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN6:$FADER6_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN7:$FADER7_LABEL]"
    - "[slmk3.sc_set_center_box_label:$SCREEN8:$FADER8_LABEL]"

    - "[slmk3.sc_set_center_box_color:$SCREEN1:$COLOR1]"
    - "[slmk3.sc_set_center_box_color:$SCREEN2:$COLOR2]"
    - "[slmk3.sc_set_center_box_color:$SCREEN3:$COLOR3]"
    - "[slmk3.sc_set_center_box_color:$SCREEN4:$COLOR4]"
    - "[slmk3.sc_set_center_box_color:$SCREEN5:$COLOR5]"
    - "[slmk3.sc_set_center_box_color:$SCREEN6:$COLOR6]"
    - "[slmk3.sc_set_center_box_color:$SCREEN7:$COLOR7]"
    - "[slmk3.sc_set_center_box_color:$SCREEN8:$COLOR8]"

    - "[slmk3.sc_set_bottom_box_label:$SCREEN1:$PART1_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN2:$PART2_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN3:$PART3_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN4:$PART4_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN5:$PART5_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN6:$PART6_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN7:$PART7_LABEL]"
    - "[slmk3.sc_set_bottom_box_label:$SCREEN8:$PART8_LABEL]"

    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN1:$PART1_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN2:$PART1_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN3:$PART1_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN4:$PART4_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN5:$PART5_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN6:$PART6_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN7:$PART7_COLOR]"
    - "[slmk3.sc_set_box_bottom_bar_color:$SCREEN8:$PART8_COLOR]"


    - "[slmk3.sc_set_center_screen_right_bar_color:$C_RIGHT_TOP_BAR:$COLOR_OFF]"
    - "[slmk3.sc_set_center_screen_right_bar_color:$C_RIGHT_BOTTOM_BAR:$COLOR_OFF]"

    - "[slmk3.stop_buffer:screen_properties]"

    - "[slmk3.set_fader_color:$FADER1:$COLOR1]"
    - "[slmk3.set_fader_color:$FADER2:$COLOR2]"
    - "[slmk3.set_fader_color:$FADER3:$COLOR3]"
    - "[slmk3.set_fader_color:$FADER4:$COLOR4]"
    - "[slmk3.set_fader_color:$FADER5:$COLOR5]"
    - "[slmk3.set_fader_color:$FADER6:$COLOR6]"
    - "[slmk3.set_fader_color:$FADER7:$COLOR7]"
    - "[slmk3.set_fader_color:$FADER8:$COLOR8]"

    - "[page.set_state:DISPLAY:faders]"


mappings:
  before_value_changes:
    - "[slmk3.start_buffer:screen_properties]"
    - "[slmk3.start_screen_change]"
    - "[slmk3.stop_buffer:screen_properties]"
  after_value_changes:
    - "[slmk3.start_buffer:screen_properties]"
    - "[slmk3.end_screen_change]"
    - "[slmk3.stop_buffer:screen_properties]"

    - "[slmk3.flush_buffer:screen_properties]"

  controls:
    slmk3.button1:
      on_press:
        - conditions:
            $_STATE.CURRENT_PAGE.isnot: page1
          actions:
            - "[session.load_page:page1]"

    slmk3.button2:
      on_press:
        - conditions:
            $_STATE.CURRENT_PAGE.isnot: page2
          actions:
            - "[session.load_page:page2]"

    slmk3.button3:
      on_press:
        - conditions:
            $_STATE.CURRENT_PAGE.isnot: page3
          actions:
            - "[session.load_page:page3]"

    slmk3.button_screen_up:
      on_press:
        - "[slmk3.start_buffer:screen_properties]"
        - "[slmk3.start_screen_change]"
        - "[slmk3.stop_buffer:screen_properties]"
        - "[page.display_encoders]"
        - "[slmk3.start_buffer:screen_properties]"
        - "[slmk3.end_screen_change]"
        - "[slmk3.stop_buffer:screen_properties]"
        - "[slmk3.flush_buffer:screen_properties]"
        - "[page.update_controller_ui]"

    slmk3.button_right_up:
      on_press:
        - "[slmk3.start_buffer:screen_properties]"
        - "[slmk3.start_screen_change]"
        - "[slmk3.stop_buffer:screen_properties]"
        - "[page.display_buttons]"
        - "[slmk3.start_buffer:screen_properties]"
        - "[slmk3.end_screen_change]"
        - "[slmk3.stop_buffer:screen_properties]"
        - "[slmk3.flush_buffer:screen_properties]"
        - "[page.update_controller_ui]"

    slmk3.button_right_down:
      on_press:
        - "[slmk3.start_buffer:screen_properties]"
        - "[slmk3.start_screen_change]"
        - "[slmk3.stop_buffer:screen_properties]"
        - "[page.display_faders]"
        - "[slmk3.start_buffer:screen_properties]"
        - "[slmk3.end_screen_change]"
        - "[slmk3.stop_buffer:screen_properties]"
        - "[slmk3.flush_buffer:screen_properties]"
        - "[page.update_controller_ui]"

    slmk3.button9:
      mapping: track1.fx1.dco_pulse_enabled
      mapping_type: toggle
      on_value_change:
        - "[session.debug: button9 - $VALUE - $MIN_VALUE - $MAX_VALUE]"
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_top_box_value:$SCREEN1:$FORMATTED_VALUE]"
            - conditions:
                $VALUE.is: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_top_box_selected:$SCREEN1:01]"
            - conditions:
                $VALUE.isnot: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_top_box_selected:$SCREEN1:00]"
            - "[slmk3.stop_buffer:screen_properties]"

        - conditions:
            $VALUE.is: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON9:$COLOR_WHITE]"

        - conditions:
            $VALUE.isnot: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON9:$COLOR_OFF]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.start_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[page.display_buttons]"
          - "[slmk3.end_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[slmk3.flush_buffer:screen_properties]"


    slmk3.button10:
      mapping: track1.fx1.dco_saw_enabled
      mapping_type: toggle
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_top_box_value:$SCREEN2:$FORMATTED_VALUE]"
            - conditions:
                $VALUE.is: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_top_box_selected:$SCREEN2:01]"
            - conditions:
                $VALUE.isnot: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_top_box_selected:$SCREEN2:00]"
            - "[slmk3.stop_buffer:screen_properties]"

        - conditions:
            $VALUE.is: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON10:$COLOR_WHITE]"

        - conditions:
            $VALUE.isnot: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON10:$COLOR_OFF]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.start_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[page.display_buttons]"
          - "[slmk3.end_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[slmk3.flush_buffer:screen_properties]"

    slmk3.button11:
      mapping: track1.fx1.dco_sub_osc_enabled
      mapping_type: toggle
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_top_box_value:$SCREEN3:$FORMATTED_VALUE]"
            - conditions:
                $VALUE.is: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_top_box_selected:$SCREEN3:01]"
            - conditions:
                $VALUE.isnot: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_top_box_selected:$SCREEN3:00]"
            - "[slmk3.stop_buffer:screen_properties]"

        - conditions:
            $VALUE.is: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON11:$COLOR_WHITE]"

        - conditions:
            $VALUE.isnot: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON11:$COLOR_OFF]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.start_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[page.display_buttons]"
          - "[slmk3.end_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[slmk3.flush_buffer:screen_properties]"

    slmk3.button12:
      mapping: track1.fx1.filter_env_mode
      mapping_type: enum
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_top_box_value:$SCREEN4:$FORMATTED_VALUE]"
            - "[slmk3.stop_buffer:screen_properties]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.start_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[page.display_buttons]"
          - "[slmk3.end_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[slmk3.flush_buffer:screen_properties]"

    slmk3.button13:
      mapping: track1.fx1.vca_mode
      mapping_type: enum
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_top_box_value:$SCREEN5:$FORMATTED_VALUE]"
            - "[slmk3.stop_buffer:screen_properties]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.start_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[page.display_buttons]"
          - "[slmk3.end_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[slmk3.flush_buffer:screen_properties]"

    slmk3.button14:
      mapping: track1.fx1.dco_pwm_mode
      mapping_type: enum
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_top_box_value:$SCREEN6:$FORMATTED_VALUE]"
            - "[slmk3.stop_buffer:screen_properties]"
      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.start_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[page.display_buttons]"
          - "[slmk3.end_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[slmk3.flush_buffer:screen_properties]"

    slmk3.button15:
      mapping: track1.fx1.chorus_1
      mapping_type: toggle
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_top_box_value:$SCREEN7:$FORMATTED_VALUE]"
            - conditions:
                $VALUE.is: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_top_box_selected:$SCREEN7:01]"
            - conditions:
                $VALUE.isnot: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_top_box_selected:$SCREEN7:00]"
            - "[slmk3.stop_buffer:screen_properties]"

        - conditions:
            $VALUE.is: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON15:$COLOR_WHITE]"

        - conditions:
            $VALUE.isnot: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON15:$COLOR_OFF]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.start_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[page.display_buttons]"
          - "[slmk3.end_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[slmk3.flush_buffer:screen_properties]"

    slmk3.button16:
      mapping: track1.fx1.chorus_2
      mapping_type: toggle
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_top_box_value:$SCREEN8:$FORMATTED_VALUE]"
            - conditions:
                $VALUE.is: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_top_box_selected:$SCREEN8:01]"
            - conditions:
                $VALUE.isnot: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_top_box_selected:$SCREEN8:00]"
            - "[slmk3.stop_buffer:screen_properties]"

        - conditions:
            $VALUE.is: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON16:$COLOR_WHITE]"

        - conditions:
            $VALUE.isnot: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON16:$COLOR_OFF]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.start_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[page.display_buttons]"
          - "[slmk3.end_screen_change]"
          - "[slmk3.stop_buffer:screen_properties]"
          - "[slmk3.flush_buffer:screen_properties]"



    slmk3.button17:
      mapping: track1.fx1.lfo_trigger_mode
      mapping_type: enum
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_center_box_value:$SCREEN1:$FORMATTED_VALUE]"
            - "[slmk3.stop_buffer:screen_properties]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[page.display_buttons]"


    slmk3.button18:
      mapping: track1.fx1.lfo_waveform
      mapping_type: enum
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_center_box_value:$SCREEN2:$FORMATTED_VALUE]"
            - "[slmk3.stop_buffer:screen_properties]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[page.display_buttons]"


    slmk3.button19:
      mapping: track1.fx1.portamento_mode
      mapping_type: enum
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_center_box_value:$SCREEN3:$FORMATTED_VALUE]"
            - "[slmk3.stop_buffer:screen_properties]"
        
      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[page.display_buttons]"

    slmk3.button20:
      mapping: track1.fx1.portamento_poly
      mapping_type: toggle
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.start_buffer:screen_properties]"
            - "[slmk3.sc_set_center_box_value:$SCREEN4:$FORMATTED_VALUE]"
            - conditions:
                $VALUE.is: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_center_box_selected:$SCREEN4:01]"
            - conditions:
                $VALUE.isnot: $MAX_VALUE
              actions:
              - "[slmk3.sc_set_center_box_selected:$SCREEN4:00]"
            - "[slmk3.stop_buffer:screen_properties]"

        - conditions:
            $VALUE.is: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON20:$COLOR_WHITE]"

        - conditions:
            $VALUE.isnot: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON20:$COLOR_OFF]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[page.display_buttons]"


    slmk3.fader1:
      mapping: track1.fx1.filter_cutoff
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: faders
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.sc_set_center_box_value:$SCREEN1:$FORMATTED_VALUE]"
          - "[slmk3.stop_buffer:screen_properties]"

      on_change:
        - conditions:
            $_STATE.DISPLAY.isnot: faders
          actions:
          - "[page.display_faders]"

    slmk3.fader2:
      mapping: track1.fx1.filter_resonance
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: faders
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.sc_set_center_box_value:$SCREEN2:$FORMATTED_VALUE]"
          - "[slmk3.stop_buffer:screen_properties]"

      on_change:
        - conditions:
            $_STATE.DISPLAY.isnot: faders
          actions:
          - "[page.display_faders]"

    slmk3.fader3:
      mapping: track1.fx1.dco_sub_osc_volume
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: faders
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.sc_set_center_box_value:$SCREEN3:$FORMATTED_VALUE]"
          - "[slmk3.stop_buffer:screen_properties]"

      on_change:
        - conditions:
            $_STATE.DISPLAY.isnot: faders
          actions:
          - "[page.display_faders]"

    slmk3.fader4:
      mapping: track1.fx1.dco_noise_volume
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: faders
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.sc_set_center_box_value:$SCREEN4:$FORMATTED_VALUE]"
          - "[slmk3.stop_buffer:screen_properties]"

      on_change:
        - conditions:
            $_STATE.DISPLAY.isnot: faders
          actions:
          - "[page.display_faders]"

    slmk3.fader5:
      mapping: track1.fx1.attack
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: faders
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.sc_set_center_box_value:$SCREEN5:$FORMATTED_VALUE]"
          - "[slmk3.stop_buffer:screen_properties]"

      on_change:
        - conditions:
            $_STATE.DISPLAY.isnot: faders
          actions:
          - "[page.display_faders]"

    slmk3.fader6:
      mapping: track1.fx1.decay
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: faders
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.sc_set_center_box_value:$SCREEN6:$FORMATTED_VALUE]"
          - "[slmk3.stop_buffer:screen_properties]"

      on_change:
        - conditions:
            $_STATE.DISPLAY.isnot: faders
          actions:
          - "[page.display_faders]"

    slmk3.fader7:
      mapping: track1.fx1.sustain
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: faders
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.sc_set_center_box_value:$SCREEN7:$FORMATTED_VALUE]"
          - "[slmk3.stop_buffer:screen_properties]"

      on_change:
        - conditions:
            $_STATE.DISPLAY.isnot: faders
          actions:
          - "[page.display_faders]"

    slmk3.fader8:
      mapping: track1.fx1.release
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: faders
          actions:
          - "[slmk3.start_buffer:screen_properties]"
          - "[slmk3.sc_set_center_box_value:$SCREEN8:$FORMATTED_VALUE]"
          - "[slmk3.stop_buffer:screen_properties]"

      on_change:
        - conditions:
            $_STATE.DISPLAY.isnot: faders
          actions:
          - "[page.display_faders]"
