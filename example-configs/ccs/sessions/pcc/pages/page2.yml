extends: _default
name: $PART2_LABEL
id: page2
on_activate:
  - "[page.set_state:CURRENT_COLOR:$PART2_COLOR]"
  - conditions:
      $_STATE.DISPLAY.is: ""
    actions:
      - "[page.display_buttons]"
  - conditions:
      $_STATE.DISPLAY.is: "encoders"
    actions:
      - "[page.display_encoders]"
  - conditions:
      $_STATE.DISPLAY.is: "buttons"
    actions:
      - "[page.display_buttons]"


variables:
  DISPLAY_ENCODERS: encoders
  DISPLAY_FADERS: faders
  DISPLAY_BUTTONS: buttons
  DISPLAY_DEFAULT: encoders

  ENCODER1_LABEL: PtchBend
  ENCODER2_LABEL: PW Filt
  ENCODER3_LABEL: Vel Env
  ENCODER4_LABEL: Vel Vol
  ENCODER5_LABEL: Glide
  ENCODER6_LABEL: Rev Mix
  ENCODER7_LABEL: Rev Size
  ENCODER8_LABEL: Voices

  BUTTON1_LABEL: $PART1_LABEL
  BUTTON2_LABEL: $PART2_LABEL
  BUTTON3_LABEL: LFO Rate
  BUTTON4_LABEL: Test 1
  BUTTON5_LABEL: Test 2
  BUTTON6_LABEL: Test 3
  BUTTON7_LABEL: Test 4
  BUTTON8_LABEL: Test 5

  BUTTON9_LABEL:  WITTI
  BUTTON10_LABEL: Saw
  BUTTON11_LABEL: Sub
  BUTTON12_LABEL: F-Env
  BUTTON13_LABEL: A-Env/G
  BUTTON14_LABEL: ""
  BUTTON15_LABEL: Chor I
  BUTTON16_LABEL: Chor II

  BUTTON17_LABEL: LfoTrMd
  BUTTON18_LABEL: LfoShape
  BUTTON19_LABEL: GldeType
  BUTTON20_LABEL: GldePoly
  BUTTON21_LABEL: ""
  BUTTON22_LABEL: ""
  BUTTON23_LABEL: ""
  BUTTON24_LABEL: ""


# To make writing pages easier, they can define their own actions too.
#actions:
  # "page.set_state" is always available as an action and lets you set custom
  # state variables.
  # In each control's action you can optionally define conditions that have to
  # be met for the current action(s) to be triggered.
  # Examples:
  # "[page.set_state:my_name:$MY_VARIABLE]y"
  # "[page.set_state:leds_show:mute]"

  # controls:
  #   button1:
  #     actions:
  #     - "[page.action_always_executed]"
  #     - conditions:
  #         - $_STATE.leds_show.is: mute
  #       actions:
  #       - "[controller.toggle_mute_track1]"



mappings:
  controls:

    slmk3.encoder1:
      mapping: track1.fx1.control_pitch_bend_dco
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: encoders
          actions:
            - "[slmk3.set_knob_value:$SCREEN1:$VALUE]"
            - "[slmk3.set_knob_value_label:$SCREEN1:$FORMATTED_VALUE]"

    slmk3.encoder2:
      mapping: track1.fx1.control_pitch_bend_filter
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: encoders
          actions:
            - "[slmk3.set_knob_value:$SCREEN2:$VALUE]"
            - "[slmk3.set_knob_value_label:$SCREEN2:$FORMATTED_VALUE]"

    slmk3.encoder3:
      mapping: track1.fx1.control_velocity_envelope
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: encoders
          actions:
          - "[slmk3.set_knob_value:$SCREEN3:$VALUE]"
          - "[slmk3.set_knob_value_label:$SCREEN3:$FORMATTED_VALUE]"

    slmk3.encoder4:
      mapping: track1.fx1.control_velocity_volume
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: encoders
          actions:
          - "[slmk3.set_knob_value:$SCREEN4:$VALUE]"
          - "[slmk3.set_knob_value_label:$SCREEN4:$FORMATTED_VALUE]"

    slmk3.encoder5:
      mapping: track1.fx1.portamento_time
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: encoders
          actions:
          - "[slmk3.set_knob_value:$SCREEN5:$VALUE]"
          - "[slmk3.set_knob_value_label:$SCREEN5:$FORMATTED_VALUE]"

    slmk3.encoder6:
      mapping: track1.fx1.fx_reverb_dry_wet
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: encoders
          actions:
          - "[slmk3.set_knob_value:$SCREEN6:$VALUE]"
          - "[slmk3.set_knob_value_label:$SCREEN6:$FORMATTED_VALUE]"

    slmk3.encoder7:
      mapping: track1.fx1.fx_reverb_size
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: encoders
          actions:
          - "[slmk3.set_knob_value:$SCREEN7:$VALUE]"
          - "[slmk3.set_knob_value_label:$SCREEN7:$FORMATTED_VALUE]"

    slmk3.encoder8:
      mapping: track1.fx1.max_voices
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: encoders
          actions:
          - "[slmk3.set_knob_value:$SCREEN8:$VALUE]"
          - "[slmk3.set_knob_value_label:$SCREEN8:$FORMATTED_VALUE]"

    slmk3.button9:
      mapping: track1.fx1.dco_pulse_enabled
      mapping_type: toggle
      # These actions are called when a plugin parameter is being changed.
      # They should just reflect the new value on the controller.
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.set_top_box_value:$SCREEN1:$FORMATTED_VALUE]"
            - conditions:
                $VALUE.is: $MAX_VALUE
              actions:
              - "[slmk3.set_top_box_selected:$SCREEN1:01]"
            - conditions:
                $VALUE.isnot: $MAX_VALUE
              actions:
              - "[slmk3.set_top_box_selected:$SCREEN1:00]"

        - conditions:
            $VALUE.is: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON9:$COLOR_WHITE]"

        - conditions:
            $VALUE.isnot: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON9:$COLOR_OFF]"

      on_press:
        - conditions:
            $_STATE.DISPLAY.isnot: buttons
          actions:
          - "[page.display_buttons]"


    slmk3.button17:
      mapping: track1.fx1.lfo_trigger_mode
      mapping_type: enum
      on_value_change:
        - conditions:
            $_STATE.DISPLAY.is: buttons
          actions:
            - "[slmk3.set_center_box_value:$SCREEN1:$FORMATTED_VALUE]"
        
        - conditions:
            $VALUE.is: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON9:$COLOR_WHITE]"

        - conditions:
            $VALUE.isnot: $MAX_VALUE
          actions:
          - "[slmk3.set_button_color:$BUTTON9:$COLOR_OFF]"


